<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>bUnit</title>

	<link rel="stylesheet" href="dist/reset.css">
	<link rel="stylesheet" href="dist/reveal.css">
	<link rel="stylesheet" href="dist/theme/black.css">

	<!-- Theme used for syntax highlighted code -->
	<link rel="stylesheet" href="plugin/highlight/monokai.css">
	<link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css' rel='stylesheet'
		type='text/css'>
	<style>
		pre {
			width: 100% !important;
		}

		pre code {
			max-height: 100% !important;
		}

		ul {
			padding: 0.5em 1em 0.5em 2.3em;
			position: relative;
		}

		ul li {
			line-height: 1.5;
			padding: 0.5em 0;
			list-style-type: none !important;
		}

		ul li:before {
			font-family: "Font Awesome 5 Free";
			font-weight: 900;
			content: "\f138";
			position: absolute;
			left: 1em;
			color: #008044;
		}

		blockquote {
			background: #f9f9f9;
			border-left: 10px solid #ccc;
			margin: 1.5em 10px;
			padding: 0.5em 10px;
			quotes: "\201C""\201D""\2018""\2019";
		}

		blockquote:before {
			color: #ccc;
			content: open-quote;
			font-size: 4em;
			line-height: 0.1em;
			margin-right: 0.25em;
			vertical-align: -0.4em;
		}

		blockquote p {
			display: inline;
		}

		disclaimer:before {
			font-family: "Font Awesome 5 Free";
			font-weight: 900;
			content: "\f06a";
			color: #FF8A65;
			padding-right: 20px;
		}
		.line { display: block; }
/* on focused: switch to solarized light */
.line.focus { background: #fdf6e3; color: #657b83; }
.line.focus .hljs-comment, .line.focus .hljs-quote { color: #93a1a1; }
.reveal .slides section .fragment.current-only {
    opacity: 1;
    visibility: visible;
    display: none;
  }
  .reveal .slides section .fragment.current-only.current-fragment {
    display: block;
  }
	</style>
</head>

<body>
	<div class="reveal">
		<div class="slides">
			<section>
				<h2>Unit testing in Blazor with:</h2>
				<h2><img style="vertical-align: middle"
						src="https://github.com/bUnit-dev/bUnit/raw/main/bunit-logo.png" /> bUnit</h2>
				<p class="fragment">... and some nice ideas about unit testing in general</p>
			</section>
			<section>
				<style>
					.container {
						align-items: center;
						display: flex;
					}

					.profile-img-container {
						display: flex;
						justify-content: center;
						flex-basis: 26%;
					}

					.profile-img {
						width: 300px;
						height: 300px;
						border-radius: 50%;
						border: white;
						margin: 4px 10px 0 4px;

						box-shadow: 0 0 0 4px white;
						background-repeat: no-repeat;
						background-position: center center;
						background-size: cover;
						background-image: url("assets/profile-picture.webp");
					}
				</style>
				<div class="container">
					<div class="profile-img-container">
						<div class="profile-img">
						</div>
					</div>
					<div style="position: relative;">
						<div style="position: absolute; z-index: -1;top: 100; right: 0;">
							<img src="assets/zühlke.png" />
						</div>
						<ul>
							<li>Software engineer here in Zurich working @Zühlke Engineering AG</li>
							<li>I ❤ Blazor and C# / .NET</li>
							<ul>
								<li>Even though these slides are written in Html / CSS / JavaScript</li>
								<li>Wrote my own blog solely in Blazor, because I love that piece of technology</li>
							</ul>
							<li>Member/Speaker in the .NET User Group Zürich</li>
							<li>Contact:
								<i class="fab fa-linkedin"></i> <a
									href="https://www.linkedin.com/in/steven-giesel/">LinkedIn</a>
								/ <i class="fas fa-blog"></i> <a href="https://steven.giesel.com/">steven-giesel.com
									(Blog)</a>
								/ <i class="fab fa-github-square"></i> <a
									href="https://github.com/linkdotnet/">Github</a>
								/ <i class="fab fa-twitter"></i> No Twitter
							</li>
						</ul>
					</div>
				</div>
			</section>
			<section>
				<h2>
					<div class="fa-border">
						<disclaimer>Disclaimer</disclaimer>
					</div>
				</h2>
				<ul>
					<li>The talk will assume you have some knowledge about Blazor and unit testing in general.</li>
					<li>If not even better, you will see how easy Blazor is ;) </li>
				</ul>
			</section>
			<section>
				<style>
					div.item {
						vertical-align: top;
						display: inline-block;
						text-align: center;
						width: 750px;
					}

					.item img {
						width: 140px;
						height: 140px;
						background-color: grey;
						border-radius: 50%;
						background-color: #fff;
						padding: 4px;
					}

					.caption {
						display: block;
					}
				</style>
				<h3>What is bUnit?</h3>
				<blockquote>bUnit is a testing library for Blazor Components. Its goal is to make it easy to write
					comprehensive, stable unit tests. </blockquote>
				<ul>
					<li>Testing library for Blazor</li>
					<li>We throw a component against and bUnit renders it (via Blazor) and offers a lot of utility</li>
					<li>Geeky extra info: Behaves generally like Blazor Server</li>
				</ul>
				<div class="fragment" style="display: flex; align-items: center; justify-content: center;">
					<div class="item">
						<img src="https://avatars.githubusercontent.com/u/105649?v=4" />
						<span class="caption">Author: Egil Hansen</span>
					</div>
					<div class="item">
						<img src="https://avatars.githubusercontent.com/u/26365461?v=4" />
						<span class="caption">Core Contributor: Steven Giesel</span>
					</div>
				</div>
			</section>
			<section>
				<h3>What does bUnit offer?</h3>
				<ul>
					<li class="fragment">Setup and define components under tests using C# or Razor syntax</li>
					<li class="fragment">Verify outcomes using semantic HTML comparer</li>
					<li class="fragment">Emulates the Blazor life cycle methods</li>
					<li class="fragment">Interact with and inspect components as well as trigger event handlers</li>
					<li class="fragment">Pass parameters, cascading values and inject services into components under
						test</li>
					<li class="fragment">Mock Services, IJSRuntime, other components, Blazor authentication and
						authorization, and others
					</li>
				</ul>
			</section>
			<section>
				<h3>What does bUnit offer?</h3>
				<br />
				<h2>Best unit test practices from the C# world</h2>
				<h2>Feels like "a regular" unit test</h2>
			</section>

			<section>
				<h3>What does bUnit <b>not</b> offer?</h3>
				<ul>
					<li class="fragment">It is not a general purpose testing framework.</li>
					<li class="fragment">It does not run in a browser. Doesn't run JavaScript.</li>
					<ul class="fragment">
						<li><b>But</b> we can assert that our JavaScript functions got called.</li>
					</ul>

				</ul>
			</section>
			<section>
				<h3>Why not Selenium / Playwright?</h3>
				<div class="fragment" style="position:relative">
					<ul>
						<li>They are slow!</li>
						<li>Expensive to build and maintain</li>
						<li>They are not unit test frameworks. They are meant for e2e test.</li>
					</ul>
					<div style="position: absolute; z-index: -1;top: 0; right: 0;">
						<img width="640" src="assets/bUnitTime.jpeg" style="transform: rotate(20deg)">
					</div>
				</div>
			</section>
			<section>
				<h3>Setup - Razor</h3>
				<img class="fragment" src="assets/Setup_XUnit.png" />
			</section>
			<section>
				<h3>Setup - Razor</h3>
				<img src="assets/Setup_Bunit_Razor.png" />
			</section>
			<section>
				<section data-background="assets/counter_sample.gif">
					<br />
					<br />
					<h3 style="color:black;filter: drop-shadow(0 0 10px purple);">Counter</h3>
				</section>
				<section>
					<h3>Counter</h3>
					<div>
						<div style="float:left;width: 60%;">
						</div>
						<div style="float:right;width:40%">
							<pre>
								<code data-trim data-noescape class="razor">
									<script type="text/template">
<h1>Counter</h1>

<p>Current count: @_currentCounter</p>
      
<button id="increment-button"
        class="btn btn-primary"
        @onclick="IncrementCount">Click me</button>

@code {
    private int _currentCounter { get; set; }

    private void IncrementCount()
    {
        _currentCounter++;
    }
}
</script>
								</code>
							</pre>
						</div>
					</div>
				</section>
				<section data-transition="none">
					<h3>Counter</h3>
					<div style="overflow:auto;">
						<div style="float:left;width: 60%;">
							<pre style="max-width: 50%;min-width: 50%;width:50%">
								<code data-trim class="razor">
@using Bunit
@using Xunit
@using bUnit.Tutorial.Shared

@inherits Bunit.TestContext

@code {

	[Fact]
	public void SomeTest()
	{
	}
}
									</code>
									</pre>
						</div>
						<div style="float:right;width:40%">
							<pre style="overflow:auto">
								<code data-trim data-noescape  class="razor">
									<script type="text/template">
<h1>Counter</h1>

<p>Current count: @_currentCounter</p>
      
<button id="increment-button"
        class="btn btn-primary"
        @onclick="IncrementCount">Click me</button>

@code {
    private int _currentCounter { get; set; }

    private void IncrementCount()
    {
        _currentCounter++;
    }
}
</script>
								</code>
							</pre>
						</div>
					</div>
					<ul style="display: block">
						<li class="fragment current-only" data-code-focus="1-99" data-code-block="1">Tests written in razor syntax</li>
					<li class="fragment current-only" data-code-focus="1-3" data-code-block="1">Imports for <b>bUnit</b>, xUnit and the component</li>
					<li class="fragment current-only" data-code-focus="5" data-code-block="1">TestContext is from bUnit which brings the functionality</li>
					<li class="fragment current-only" data-code-focus="9-12" data-code-block="1">We can write our unit tests as we used to</li>
					</ul>
				</section>
		
				<section data-transition="none">
					<h3>Counter - Why bUnit</h3>
					<div >
						<div style="float:left;width: 60% ;position: relative;">
							<img src="assets/completion.jpg" style="position: absolute; top: 178px; right: 470px; z-index: 100;"/>
							<pre style="max-width: 50%;min-width: 50%;width:50%">
								<code data-trim data-noescape class="razor">
@using Bunit
@using Xunit
@using bUnit.Tutorial.Shared

@inherits Bunit.TestContext

@code {

	[Fact]
	public void SomeTest()
	{
		var cut = new Counter();
		cut.
	}
}
									</code>
									</pre>
						</div>
						<div style="float:right;width:40%">
							<pre style="overflow:auto">
								<code data-trim data-noescape class="razor">
									<script type="text/template">
<h1>Counter</h1>

<p>Current count: @_currentCounter</p>
      
<button id="increment-button"
        class="btn btn-primary"
        @onclick="IncrementCount">Click me</button>

@code {
    private int _currentCounter { get; set; }

    private void IncrementCount()
    {
        _currentCounter++;
    }
}
</script>
								</code>
							</pre>
						</div>
					</div>
					<ul class="fragment current-only" data-code-focus="13" data-code-block="1">
						<li>Every Blazor component can be simply created via new() but component doesn't know how to render itself</li>
						<li>Does not help as only SetParametersAsync is exposed, the rest comes from System.Object</li>
						<li>Doesn't help with life cycle events</li>
					</ul>
					<ul class="fragment current-only" data-code-focus="5,12-15" data-code-block="2">
						<li>Everything is private.</li>
						<li>How to click the button? How to invoke function from the outside?</li>
					</ul>
				</section>
				<section>
					<h3>The Test</h3>
				</section>
				<section data-transition="none">
					<h3>Counter</h3>
					<div style="overflow:auto;">
						<div style="float:left;width: 60%;">
							<pre style="max-width: 90%">
								<code data-trim class="razor">
									<script type="text/template">
@using AngleSharp.Dom
@using Bunit
@using Xunit
@using bUnit.Tutorial.Shared

@inherits Bunit.TestContext

@code {

	[Fact]
	public void IncrementCounterByOneWhenButtonClicked()
	{
		// Render our component including all lifecycle events
		var cut = Render(@<Counter />);

		// Find the button via CSS selector and click it
		IElement button = cut.Find("button");
		button.Click();

		// Assert the markup
		var pElement = cut.Find("p");
		pElement.MarkupMatches(@<p>Current count: 1</p>);
	}
}
</script></code>
									</pre>
						</div>
						<div style="float:right;width:40%">
							<pre style="overflow:auto">
								<code data-trim data-noescape  class="razor">
									<script type="text/template">
<h1>Counter</h1>

<p>Current count: @_currentCounter</p>
      
<button id="increment-button"
        class="btn btn-primary"
        @onclick="IncrementCount">Click me</button>

@code {
    private int _currentCounter { get; set; }

    private void IncrementCount()
    {
        _currentCounter++;
    }
}
</script>
								</code>
							</pre>
						</div>
					</div>
					<ul style="display: block">
						<li class="fragment current-only" data-code-focus="14" data-code-block="1">Render the component via Blazor Pipeline including all lifecycle events</li>
						<li class="fragment current-only" data-code-focus="1,17-18" data-code-block="1">Like Selenium or Playwright: Get an element via css selector. Find returns as an AngleSharp.Dom.IElement. Super convenient. More later.</li>
						<li class="fragment current-only" data-code-focus="21-22" data-code-block="1">Compare the markup</li>
					</ul>
				</section>
				<section>
					<h3>Semantic comparing</h3>
				</section>
				<section>
					<h3>Question: Are these two markups identical?</h3>
					<div>
						<div  style="float:left;width:45%">
							<pre>
								<code data-trim data-noescape  class="html">
									<script type="text/template">
										<p>
											That is a test
										</p>
									</script>
								</code>
							</pre>
						</div>
						<div style="float:right;width: 45%;">
							<pre>
								<code data-trim data-noescape  class="html">
									<script type="text/template">
										<p>That is a    test</p>
									</script>
								</code>
							</pre>
						</div>
					</div>				
				</section>
				<section>
					<h3>Question: Are these two markups identical?</h3>
					<div>
						<div  style="float:left;width:45%">
							<pre>
								<code data-trim data-noescape  class="html">
									<script type="text/template">
										<p class="style-1 style-2">That is a test</p>
									</script>
								</code>
							</pre>
						</div>
						<div style="float:right;width: 45%;">
							<pre>
								<code data-trim data-noescape  class="html">
									<script type="text/template">
										<p class="style-2 style-1">That is a test</p>
									</script>
								</code>
							</pre>
						</div>
					</div>				
				</section>
				<section>
					<h3>Question: Are these two markups identical?</h3>
					<div>
						<div  style="float:left;width:45%">
							<pre>
								<code data-trim data-noescape  class="html">
									<script type="text/template">
										<p>That is a test</p>
									</script>
								</code>
							</pre>
						</div>
						<div style="float:right;width: 45%;">
							<pre>
								<code data-trim data-noescape  class="html">
									<script type="text/template">
										<p class="style-2 style-1">That is a test</p>
									</script>
								</code>
							</pre>
						</div>
					</div>		
				</section>
				<section data-transition="none">
					<h3>Counter</h3>
					<div style="overflow:auto;">
						<div style="float:left;width: 60%;">
							<pre style="max-width: 90%">
								<code data-trim class="razor">
									<script type="text/template">
@using AngleSharp.Dom
@using Bunit
@using Xunit
@using bUnit.Tutorial.Shared

@inherits Bunit.TestContext

@code {

	[Fact]
	public void IncrementCounterByOneWhenButtonClicked()
	{
		// Render our component including all lifecycle events
		var cut = Render(@<Counter />);

		// Find the button via CSS selector and click it
		IElement button = cut.Find("button");
		button.Click();

		// Assert the markup
		var pElement = cut.Find("p");
		pElement.MarkupMatches(@<p>Current count: 1</p>);
	}
}
</script></code>
									</pre>
						</div>
						<div style="float:right;width:40%">
							<pre style="overflow:auto">
								<code data-trim data-noescape  class="razor">
									<script type="text/template">
<h1>Counter</h1>

<p>Current count: @_currentCounter</p>
      
<button id="increment-button"
        class="btn btn-primary"
        @onclick="IncrementCount">Click me</button>

@code {
    private int _currentCounter { get; set; }

    private void IncrementCount()
    {
        _currentCounter++;
    }
}
</script>
								</code>
							</pre>
						</div>
					</div>
				</section>
				<section data-transition="none">
					<h3>Counter</h3>
					<div style="overflow:auto;">
						<div style="float:left;width: 60%;">
							<pre style="max-width: 90%">
								<code data-trim class="razor">
									<script type="text/template">
@using AngleSharp.Dom
@using Bunit
@using Xunit
@using bUnit.Tutorial.Shared

@inherits Bunit.TestContext

@code {

	[Fact]
	public void IncrementCounterByOneWhenButtonClicked()
	{
		// Render our component including all lifecycle events
		var cut = Render(@<Counter />);

		// Find the button via CSS selector and click it
		IElement button = cut.Find("#increment-button");
		button.Click();

		// Assert the markup
		var pElement = cut.Find(".some-text");
		pElement.MarkupMatches(@<p diff:ignore>Current count: 1</p>);
	}
}
</script></code>
									</pre>
						</div>
						<div style="float:right;width:40%">
							<pre style="overflow:auto">
								<code data-trim data-noescape  class="razor">
									<script type="text/template">
<h1>Counter</h1>

<p class="some-text">Current count: @_currentCounter</p>
      
<button id="increment-button"
        class="btn btn-primary"
        @onclick="IncrementCount">Click me</button>

@code {
    private int _currentCounter { get; set; }

    private void IncrementCount()
    {
        _currentCounter++;
    }
}
</script>
								</code>
							</pre>
						</div>
					</div>
					<ul class="current-only fragment" data-code-focus="17,21" data-code-block="1">
						<li>We can also use css-selectors like an id or the class</li>
					</ul>
					<ul class="current-only fragment" data-code-focus="3,5" data-code-block="2">
						<li>We can also use css-selectors like an id or the class</li>
					</ul>
					<ul class="current-only fragment" data-code-focus="22" data-code-block="1">
						<li>Match the markup but ignore every attribute</li>
					</ul>
				</section>
				<section>
					<h3>But wait there is more!We can use AngleSharp as well.</h3>
				</section>
				<section data-transition="none">
					<h3>Counter</h3>
					<div style="overflow:auto;">
						<div style="float:left;width: 60%;">
							<pre style="max-width: 90%" class="fragment current-only">
								<code data-trim class="cshtml">
									<script type="text/template">
@using AngleSharp.Dom
@using Bunit
@using Xunit
@using bUnit.Tutorial.Shared

@inherits Bunit.TestContext

@code {

	[Fact]
	public void IncrementCounterByOneWhenButtonClicked()
	{
		// Render our component including all lifecycle events
		var cut = Render(@<Counter />);

		// Find the button via CSS selector and click it
		IElement button = cut.Find("#increment-button");
		button.Click();

		// Assert the markup
		var pElement = cut.Find(".some-text");
		pElement.MarkupMatches(@<p diff:ignore>Current count: 1</p>);
	}
}
</script></code>
									</pre>
									<pre style="max-width: 90%" class="fragment">
										<code data-trim class="razor">
											<script type="text/template">
@using AngleSharp.Dom
@using Bunit
@using Xunit
@using bUnit.Tutorial.Shared

@inherits Bunit.TestContext

@code {

	[Fact]
	public void IncrementCounterByOneWhenButtonClicked()
	{
		// Render our component including all lifecycle events
		var cut = Render(@<Counter />);

		// Find the button via CSS selector and click it
		IElement button = cut.Find("#increment-button");
		button.Click();

		// Assert the markup
		var pElement = cut.Find(".some-text");
		Assert.Equal("Current count: 1", pElement.TextContent);
	}
}
		</script></code>
											</pre>
						</div>
						<div style="float:right;width:40%">
							<pre style="overflow:auto">
								<code data-trim data-noescape  class="razor">
									<script type="text/template">
<h1>Counter</h1>

<p class="some-text">Current count: @_currentCounter</p>
      
<button id="increment-button"
        class="btn btn-primary"
        @onclick="IncrementCount">Click me</button>

@code {
    private int _currentCounter { get; set; }

    private void IncrementCount()
    {
        _currentCounter++;
    }
}
</script>
								</code>
							</pre>
						</div>
					</div>
					<ul class="current-only fragment" data-code-focus="22" data-code-block="2">
						<li>We can directly get the TextContent from an AngleSharp.Dom.IElement</li>
						<li>Enables us to use our favourite testing framework like Shouldly or FluentAssertions</li>
						<li>We don't break on markup changes</li>
					</ul>
				</section>
				<section>
					<h3>Conclusion</h3>
					<ul>
						<li class="fragment">Try to test semantic not structure.</li>
						<li class="fragment">If your structure changes your test becomes invalid as well.</li>
						<li class="fragment">Well that's bad!</li>
					</ul>
				</section>
			</section>
			<section>
				<h3>What will follow</h3>
				<ul>
					<li>Using Parameter for our counter and test this</li>
					<li>Stub and Mock a 3rd Party Blazor component plus good practices</li>
					<li>If time: JSInterop - How to check if JS was invoked</li>
				</ul>
			</section>
			<section>
				<h3>Resources:</h3>
				<ul>
					<li> <i class="fab fa-github-square"></i> bUnit repository: <a
							href="https://github.com/bUnit-dev/bUnit">https://github.com/bUnit-dev/bUnit</a></li>
					<li> <i class="fas fa-book"></i> Documentation: <a href="https://bunit.dev/">https://bunit.dev/</a>
					</li>
					<li> <i class="fas fa-blog"></i> Starter Tutorial: <a
							href="https://steven-giesel.com/blogPost/a0790df4-ba49-4346-83e7-5c3c651d594e">https://steven-giesel.com/</a>
					</li>
				</ul>
			</section>
		</div>
	</div>

	<script src="dist/reveal.js"></script>
	<script src="plugin/notes/notes.js"></script>
	<script src="plugin/highlight/highlight.js"></script>
	<script>
		// More info about initialization & config:
		// - https://revealjs.com/initialization/
		// - https://revealjs.com/config/
		Reveal.initialize({
			hash: true,
			height: '100%',
			width: '100%',
			history: false,
			pdfSeparateFragments: true,

			// Learn about plugins: https://revealjs.com/plugins/
			plugins: [RevealHighlight, RevealNotes],
			dependencies: [
				{ src: 'http://jlhg.github.io/highlight-pack/highlight.pack.js' },
				{
				src: 'plugin/reveal-code-focus.js',
				async: true,
				callback: function() {
					RevealCodeFocus();
				}
				}
			]
		});
	</script>
</body>
</html>